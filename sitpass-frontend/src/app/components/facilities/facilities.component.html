<div class="mb-4 flex items-center justify-between rounded-xl bg-slate-900 px-4 py-3 text-slate-100 shadow-md">
  <div>
    <h1 class="text-xl font-semibold">Fitness objekti</h1>
    <p class="text-sm text-slate-300">Pretraga po nazivu, opisu i PDF sadrzaju</p>
  </div>
  <div class="flex items-center">
    <span class="rounded-md bg-slate-800 px-3 py-2 text-xs text-slate-300">
      Prikazano: {{ filteredFacilities.length }}
    </span>
  </div>
</div>

<div class="container mx-auto flex items-start gap-4 p-0">
  <div class="h-fit w-full max-w-xs self-start rounded-xl border border-slate-200 bg-white p-4 shadow-sm">
    <h2 class="mb-4 text-lg font-bold text-slate-800">Pretraga i filteri</h2>
    <form (ngSubmit)="onSearch()" class="flex flex-col space-y-3">
      <input
        type="text"
        [(ngModel)]="searchQuery"
        name="search"
        placeholder="Naziv/opis/PDF..."
        class="rounded-md border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-cyan-500"
      />
      <input
        type="text"
        [(ngModel)]="filterCriteria.city"
        name="city"
        placeholder="Grad"
        class="rounded-md border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-cyan-500"
      />
      <input
        type="text"
        [(ngModel)]="filterCriteria.discipline"
        name="discipline"
        placeholder="Disciplina"
        class="rounded-md border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-cyan-500"
      />
      <div class="grid grid-cols-2 gap-2">
        <input
          type="number"
          [(ngModel)]="filterCriteria.minRating"
          name="minRating"
          placeholder="Min ocena"
          class="rounded-md border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-cyan-500"
        />
        <input
          type="number"
          [(ngModel)]="filterCriteria.maxRating"
          name="maxRating"
          placeholder="Max ocena"
          class="rounded-md border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-cyan-500"
        />
      </div>
      <select
        [(ngModel)]="filterCriteria.workDay"
        name="workDay"
        class="rounded-md border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-cyan-500"
      >
        <option value="">Dan u nedelji</option>
        <option value="monday">Monday</option>
        <option value="tuesday">Tuesday</option>
        <option value="wednesday">Wednesday</option>
        <option value="thursday">Thursday</option>
        <option value="friday">Friday</option>
        <option value="saturday">Saturday</option>
        <option value="sunday">Sunday</option>
      </select>
      <button
        type="submit"
        class="rounded-md bg-cyan-600 px-4 py-2 text-white transition hover:bg-cyan-500"
      >
        Primeni
      </button>
      <button
        type="button"
        class="rounded-md bg-slate-200 px-4 py-2 text-slate-700 transition hover:bg-slate-300"
        (click)="clearFilters()"
      >
        Ocisti
      </button>
    </form>
  </div>

  <div class="w-full">
    <div *ngIf="isLoading" class="rounded-xl border border-slate-200 bg-white p-6 text-sm text-slate-600 shadow-sm">
      Ucitavanje objekata...
    </div>
    <div *ngIf="!isLoading && errorMessage" class="mb-4 rounded-xl border border-rose-200 bg-rose-50 p-4 text-sm text-rose-700">
      {{ errorMessage }}
    </div>

    <div class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3">
      <div
        *ngFor="let facility of filteredFacilities"
        class="overflow-hidden rounded-xl border border-slate-200 bg-white shadow-sm"
      >
        <img
          [src]="getFacilityImageUrl(facility)"
          alt="{{ facility.name }}"
          class="h-44 w-full object-cover"
        />
        <div class="space-y-2 p-4">
          <h2
            [routerLink]="['/gym', facility.id]"
            class="cursor-pointer text-lg font-semibold text-slate-900 hover:text-cyan-600"
          >
            {{ facility.name }}
          </h2>
          <p class="line-clamp-2 text-sm text-slate-600">{{ facility.description }}</p>
          <p class="text-sm text-slate-600"><strong>Adresa:</strong> {{ facility.address }}</p>
          <p class="text-sm text-slate-600"><strong>Grad:</strong> {{ facility.city }}</p>
          <p class="text-sm text-slate-600"><strong>Ocena:</strong> {{ facility.totalRating }}</p>

          <button
            class="mb-2 rounded-md bg-blue-600 px-3 py-2 text-sm text-white transition hover:bg-blue-500 disabled:bg-gray-400"
            [disabled]="!facility.pdfObjectKey"
            (click)="downloadPdf(facility)"
          >
            Download PDF
          </button>

          <div>
            <h3 class="mb-1 text-sm font-bold text-slate-800">Disciplines</h3>
            <ul class="space-y-1 text-sm text-slate-600">
              <li *ngFor="let discipline of facility.disciplines">- {{ discipline.name }}</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div
      *ngIf="!isLoading && !errorMessage && filteredFacilities.length === 0"
      class="mt-4 rounded-xl border border-slate-200 bg-white p-6 text-center text-slate-600 shadow-sm"
    >
      Nema objekata za zadate filtere.
    </div>
  </div>
</div>
